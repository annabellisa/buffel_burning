
# should work from any dir, see installation instructions below

blastn -h

# base dir

# OneDrive causes havoc to this script because of the spaces. I can deal with them by wrapping the names in quotes (e.g. "$data_dir") but this is not working for running the software. So I'm going to cd to the analysis dir

cd 'OneDrive - The University of Queensland/TEACHING/UQ_Masters_and_special_topic/Binyin_Winter/Analysis/RESULTS/BLAST'

ls 

out_dir='BLAST_DB'
echo $out_dir
ls $out_dir

# all sequences:
db_infile="DCen19_seqs.fa"
db_outfile=${out_dir}/DCen19_blastDB
results_out="DCen19_result.out"

echo $db_infile
head -5 $db_infile
echo $db_outfile
echo $results_out
ls $out_dir

# make database:

makeblastdb -in $db_infile -out $db_outfile -parse_seqids -dbtype nucl

# run blast:
# make sure you use an n dash!
blastn -db $db_outfile -query $db_infile -out $results_out -outfmt 7

blastn -option








# http://www.metagenomics.wiki/tools/blast/error-too-many-positional-arguments

# https://www.biostars.org/p/9697/


# I think blastall is from the old program, the new one might be blastn, but this seems to be a useful approach:


and why not to use standard blastall?

to create db just type:

formatdb -i your_sequences.fasta

to make search ( -a no of cores to use; -m tabular output):

blastall -pblastp -d your_sequences.fasta -i your_sequences.fasta -a no_of_threads -m8 -o blast_output



# Also see https://www.biostars.org/p/9161/

I have run the blastn option in blastall with the following command:

blastall -p blastn -i query.fa -d subject -e 0.00001 -v 1 -b 1 -o blastn.blastn -a 14

and blastn in the BLAST+ package with:

blastn -task blastn -query query.fa -db subject -evalue 0.00001 -num_descriptions 1 -num_alignments 1 -out blastn.blastn -num_threads 14

using the same query and subject data. I have obtained more hits using the BLAST+ blastn, and these hits also had higher bit scores and much lower E values.

Just wondering if others have had the same experience, and whether this could be because the underlying algorithm/default parameters of blastn are different between the blastall and BLAST+ versions.








# Installation:
# https://www.ncbi.nlm.nih.gov/books/NBK52640/
# "Note that with BLASTDB unspecified, BLAST+ programs only search the working directory, i.e. the directory where BLAST command is issued"

export PATH=$PATH:$HOME/ncbi-blast-2.7.1+/bin
mkdir $HOME/blastdb
export BLASTDB=$HOME/blastdb




# From the root directory (see note above - can't get this to work in the blast command)

data_dir='OneDrive - The University of Queensland/TEACHING/UQ_Masters_and_special_topic/Binyin_Winter/Analysis/RESULTS/BLAST'
ls "$data_dir"

out_dir='OneDrive - The University of Queensland/TEACHING/UQ_Masters_and_special_topic/Binyin_Winter/Analysis/RESULTS/BLAST/BLAST_DB'
echo "$out_dir"
ls "$out_dir"







